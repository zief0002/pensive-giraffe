<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.545">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-08-05">

<title>EPsy 8264 - r paste(emo::ji('memo'), 'Regression Diagnostics')</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<link href="../site_libs/pagedtable/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable/js/pagedtable.js"></script>
<script src="https://kit.fontawesome.com/e5da75ca36.js" crossorigin="anonymous"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../assets/style.css">
<link rel="stylesheet" href="../assets/notes.css">
<link rel="stylesheet" href="../assets/table-styles.css">
</head>

<body class="nav-sidebar nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">EPsy 8264</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../schedule.html">Schedule</a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-assignments" role="button" data-bs-toggle="dropdown" aria-expanded="false">Assignments</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-assignments">    
        <li>
    <a class="dropdown-item" href="../assignments.html">
 <span class="dropdown-text">Assignment Due Dates</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assignments/assignment-01.html">
 <span class="dropdown-text">Assignment 01</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assignments/assignment-02.html">
 <span class="dropdown-text">Assignment 02</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assignments/assignment-03.html">
 <span class="dropdown-text">Assignment 03</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assignments/assignment-04.html">
 <span class="dropdown-text">Assignment 04</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assignments/assignment-05.html">
 <span class="dropdown-text">Assignment 05</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assignments/assignment-06.html">
 <span class="dropdown-text">Assignment 06</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assignments/assignment-07.html">
 <span class="dropdown-text">Assignment 07</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assignments/assignment-08.html">
 <span class="dropdown-text">Assignment 08</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../data.html">Data</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">Instructor &amp; TA</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#effect-of-female-education-level" id="toc-effect-of-female-education-level" class="nav-link active" data-scroll-target="#effect-of-female-education-level">Effect of Female Education Level</a></li>
  <li><a href="#identifying-extreme-observations" id="toc-identifying-extreme-observations" class="nav-link" data-scroll-target="#identifying-extreme-observations">Identifying Extreme Observations</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">üìù Regression Diagnostics</h1>
<p class="subtitle lead">Identifying Extreme Observations</p>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 5, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="cell">

</div>
<p>In this set of notes, we will give a brief introduction to empirical diagnostics to detect extreme observations. We will use the <a href="https://raw.githubusercontent.com/zief0002/pensive-giraffe/main/data/contraception.csv">contracption.csv</a> data to evaluate the effect of fermale education level on contraception rates.</p>
<ul>
<li><a href="https://raw.githubusercontent.com/zief0002/pensive-giraffe/main/data/contraception.csv">[CSV]</a></li>
<li><a href="../codebooks/contraception.html">[Codebook]</a></li>
</ul>
<p>A script file for the analyses in these notes is also available:</p>
<ul>
<li><a href="https://raw.githubusercontent.com/zief0002/pensive-giraffe/main/scripts/03-regression-diagnostics.R">[R Script File]</a></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Import data</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>contraception <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"~/Documents/github/epsy-8264/data/contraception.csv"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>contraception</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["region"],"name":[2],"type":["chr"],"align":["left"]},{"label":["contraceptive"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["educ_female"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["gni"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"Algeria","2":"Middle East and North Africa","3":"57","4":"5.9","5":"High"},{"1":"Austria","2":"Europe and Central Asia","3":"66","4":"8.9","5":"High"},{"1":"Azerbaijan","2":"Europe and Central Asia","3":"55","4":"10.5","5":"High"},{"1":"Bangladesh","2":"South Asia","3":"62","4":"4.6","5":"Low"},{"1":"Belgium","2":"Europe and Central Asia","3":"67","4":"10.5","5":"High"},{"1":"Belize","2":"Latin America and the Caribbean","3":"51","4":"9.2","5":"High"},{"1":"Benin","2":"Sub-Saharan Africa","3":"16","4":"2.0","5":"Low"},{"1":"Bolivia","2":"Latin America and the Caribbean","3":"67","4":"8.4","5":"Low"},{"1":"Bosnia and Herzegovina","2":"Europe and Central Asia","3":"46","4":"7.2","5":"High"},{"1":"Botswana","2":"Sub-Saharan Africa","3":"53","4":"8.7","5":"High"},{"1":"Bulgaria","2":"Europe and Central Asia","3":"69","4":"10.6","5":"High"},{"1":"Burkina Faso","2":"Sub-Saharan Africa","3":"32","4":"1.9","5":"Low"},{"1":"Burundi","2":"Sub-Saharan Africa","3":"29","4":"2.2","5":"Low"},{"1":"Cambodia","2":"East Asia and Pacific","3":"56","4":"3.2","5":"Low"},{"1":"Cameroon","2":"Sub-Saharan Africa","3":"34","4":"5.1","5":"Low"},{"1":"Canada","2":"North America","3":"85","4":"12.3","5":"High"},{"1":"Chad","2":"Sub-Saharan Africa","3":"6","4":"0.6","5":"Low"},{"1":"Chile","2":"Latin America and the Caribbean","3":"76","4":"9.6","5":"High"},{"1":"Colombia","2":"Latin America and the Caribbean","3":"81","4":"7.0","5":"High"},{"1":"Congo, Democratic Republic","2":"Sub-Saharan Africa","3":"20","4":"2.1","5":"Low"},{"1":"Costa Rica","2":"Latin America and the Caribbean","3":"78","4":"8.4","5":"High"},{"1":"Croatia","2":"Europe and Central Asia","3":"69","4":"10.5","5":"High"},{"1":"Czech Republic","2":"Europe and Central Asia","3":"86","4":"12.1","5":"High"},{"1":"Dominican Republic","2":"Latin America and the Caribbean","3":"70","4":"7.7","5":"High"},{"1":"Ecuador","2":"Latin America and the Caribbean","3":"80","4":"7.4","5":"High"},{"1":"Egypt, Arab Republic","2":"Middle East and North Africa","3":"59","4":"5.3","5":"Low"},{"1":"El Salvador","2":"Latin America and the Caribbean","3":"72","4":"6.1","5":"Low"},{"1":"Ethiopia","2":"Sub-Saharan Africa","3":"40","4":"1.4","5":"Low"},{"1":"France","2":"Europe and Central Asia","3":"78","4":"10.9","5":"High"},{"1":"Ghana","2":"Sub-Saharan Africa","3":"31","4":"5.9","5":"Low"},{"1":"Greece","2":"Europe and Central Asia","3":"76","4":"9.9","5":"High"},{"1":"Guinea","2":"Sub-Saharan Africa","3":"9","4":"0.8","5":"Low"},{"1":"Haiti","2":"Latin America and the Caribbean","3":"34","4":"3.2","5":"Low"},{"1":"Honduras","2":"Latin America and the Caribbean","3":"73","4":"5.3","5":"Low"},{"1":"Hungary","2":"Europe and Central Asia","3":"62","4":"11.2","5":"High"},{"1":"India","2":"South Asia","3":"54","4":"3.2","5":"Low"},{"1":"Indonesia","2":"East Asia and Pacific","3":"61","4":"6.9","5":"Low"},{"1":"Iraq","2":"Middle East and North Africa","3":"53","4":"4.4","5":"High"},{"1":"Italy","2":"Europe and Central Asia","3":"65","4":"9.7","5":"High"},{"1":"Jamaica","2":"Latin America and the Caribbean","3":"73","4":"9.8","5":"High"},{"1":"Japan","2":"East Asia and Pacific","3":"40","4":"11.2","5":"High"},{"1":"Jordan","2":"Middle East and North Africa","3":"52","4":"9.4","5":"High"},{"1":"Kazakhstan","2":"Europe and Central Asia","3":"55","4":"10.2","5":"High"},{"1":"Kenya","2":"Sub-Saharan Africa","3":"61","4":"5.4","5":"Low"},{"1":"Korea, Republic","2":"East Asia and Pacific","3":"80","4":"11.1","5":"High"},{"1":"Lao PDR","2":"East Asia and Pacific","3":"54","4":"3.8","5":"Low"},{"1":"Lebanon","2":"Middle East and North Africa","3":"55","4":"7.6","5":"High"},{"1":"Lesotho","2":"Sub-Saharan Africa","3":"60","4":"6.8","5":"Low"},{"1":"Liberia","2":"Sub-Saharan Africa","3":"31","4":"2.3","5":"Low"},{"1":"Madagascar","2":"Sub-Saharan Africa","3":"48","4":"4.8","5":"Low"},{"1":"Malawi","2":"Sub-Saharan Africa","3":"59","4":"3.4","5":"Low"},{"1":"Malaysia","2":"East Asia and Pacific","3":"52","4":"9.2","5":"High"},{"1":"Maldives","2":"South Asia","3":"19","4":"5.4","5":"High"},{"1":"Mali","2":"Sub-Saharan Africa","3":"16","4":"1.4","5":"Low"},{"1":"Malta","2":"Middle East and North Africa","3":"86","4":"9.5","5":"High"},{"1":"Mauritius","2":"Sub-Saharan Africa","3":"64","4":"8.0","5":"High"},{"1":"Mexico","2":"Latin America and the Caribbean","3":"67","4":"8.1","5":"High"},{"1":"Moldova","2":"Europe and Central Asia","3":"60","4":"9.6","5":"Low"},{"1":"Mongolia","2":"East Asia and Pacific","3":"55","4":"8.5","5":"Low"},{"1":"Morocco","2":"Middle East and North Africa","3":"71","4":"3.2","5":"Low"},{"1":"Mozambique","2":"Sub-Saharan Africa","3":"27","4":"0.8","5":"Low"},{"1":"Namibia","2":"Sub-Saharan Africa","3":"56","4":"6.3","5":"High"},{"1":"Nepal","2":"South Asia","3":"53","4":"2.4","5":"Low"},{"1":"Nicaragua","2":"Latin America and the Caribbean","3":"80","4":"4.8","5":"Low"},{"1":"Niger","2":"Sub-Saharan Africa","3":"11","4":"0.8","5":"Low"},{"1":"Nigeria","2":"Sub-Saharan Africa","3":"28","4":"4.2","5":"Low"},{"1":"Pakistan","2":"South Asia","3":"34","4":"3.3","5":"Low"},{"1":"Panama","2":"Latin America and the Caribbean","3":"63","4":"9.6","5":"High"},{"1":"Paraguay","2":"Latin America and the Caribbean","3":"68","4":"7.5","5":"High"},{"1":"Philippines","2":"East Asia and Pacific","3":"54","4":"8.8","5":"Low"},{"1":"Portugal","2":"Europe and Central Asia","3":"74","4":"8.0","5":"High"},{"1":"Romania","2":"Europe and Central Asia","3":"70","4":"10.4","5":"High"},{"1":"Rwanda","2":"Sub-Saharan Africa","3":"53","4":"3.1","5":"Low"},{"1":"Sao Tome and Principe","2":"Sub-Saharan Africa","3":"41","4":"4.0","5":"Low"},{"1":"Senegal","2":"Sub-Saharan Africa","3":"28","4":"3.4","5":"Low"},{"1":"Serbia","2":"Europe and Central Asia","3":"58","4":"9.2","5":"High"},{"1":"Sierra Leone","2":"Sub-Saharan Africa","3":"23","4":"2.0","5":"Low"},{"1":"Slovak Republic","2":"Europe and Central Asia","3":"80","4":"11.6","5":"High"},{"1":"Slovenia","2":"Europe and Central Asia","3":"79","4":"11.8","5":"High"},{"1":"South Africa","2":"Sub-Saharan Africa","3":"55","4":"9.8","5":"High"},{"1":"Spain","2":"Europe and Central Asia","3":"71","4":"9.5","5":"High"},{"1":"Suriname","2":"Latin America and the Caribbean","3":"48","4":"7.3","5":"High"},{"1":"Swaziland","2":"Sub-Saharan Africa","3":"66","4":"7.4","5":"Low"},{"1":"Tajikistan","2":"Europe and Central Asia","3":"29","4":"10.0","5":"Low"},{"1":"Tanzania","2":"Sub-Saharan Africa","3":"38","4":"4.5","5":"Low"},{"1":"Thailand","2":"East Asia and Pacific","3":"78","4":"7.0","5":"High"},{"1":"Togo","2":"Sub-Saharan Africa","3":"20","4":"3.3","5":"Low"},{"1":"Tunisia","2":"Middle East and North Africa","3":"63","4":"5.5","5":"Low"},{"1":"Uganda","2":"Sub-Saharan Africa","3":"42","4":"4.3","5":"Low"},{"1":"Ukraine","2":"Europe and Central Asia","3":"65","4":"11.2","5":"Low"},{"1":"United Kingdom","2":"Europe and Central Asia","3":"84","4":"12.8","5":"High"},{"1":"Uruguay","2":"Latin America and the Caribbean","3":"80","4":"8.7","5":"High"},{"1":"Venezuela, RB","2":"Latin America and the Caribbean","3":"75","4":"8.7","5":"High"},{"1":"Vietnam","2":"East Asia and Pacific","3":"76","4":"5.2","5":"Low"},{"1":"Yemen, Republic","2":"Middle East and North Africa","3":"34","4":"1.2","5":"Low"},{"1":"Zambia","2":"Sub-Saharan Africa","3":"49","4":"5.8","5":"Low"},{"1":"Zimbabwe","2":"Sub-Saharan Africa","3":"67","4":"6.7","5":"Low"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><br></p>
<section id="effect-of-female-education-level" class="level1">
<h1>Effect of Female Education Level</h1>
<p>To evaluate the effect of female education level on contraception rates, we need to fit a model that includes that effect. Since we know that a country‚Äôs wealth also has an impact on contraception rates, we also want to include that effect, which is measured by GNI, in the model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dummy variable for GNI indicator and single letter variable</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>contraception <span class="ot">=</span> contraception <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">high_gni =</span> <span class="fu">if_else</span>(gni <span class="sc">==</span> <span class="st">"High"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">gni2 =</span> <span class="fu">str_sub</span>(contraception<span class="sc">$</span>gni, <span class="at">start =</span> 1L, <span class="at">end =</span> 1L)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will then examine a scatterplot of the data to determine whether we should fit a main effects or interaction model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> contraception, <span class="fu">aes</span>(<span class="at">x =</span> educ_female, <span class="at">y =</span> contraceptive, <span class="at">color =</span> gni2)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> gni2)) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Female education level"</span>) <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Contraceptive rate"</span>) <span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  ggsci<span class="sc">::</span><span class="fu">scale_color_d3</span>() <span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-regression-diagnostics-2023_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
<p>This plot suggests that the effect of female education level may differ for low and high wealth countries. This suggests that we may want to fit an intewraction model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit interaction model</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lm</span>(contraceptive <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> educ_female <span class="sc">+</span> high_gni <span class="sc">+</span> educ_female<span class="sc">:</span>high_gni, <span class="at">data =</span> contraception)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level information</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["r.squared"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["adj.r.squared"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sigma"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["df.residual"],"name":[11],"type":["int"],"align":["right"]},{"label":["nobs"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"0.4966554","2":"0.4804185","3":"14.40447","4":"30.58803","5":"7.568139e-14","6":"3","7":"-394.3459","8":"798.6917","9":"811.5653","10":"19296.45","11":"93","12":"97"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level information</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm<span class="fl">.1</span>, <span class="at">conf.int =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"25.093822","3":"4.0606266","4":"6.1797904","5":"0.00000001683065","6":"17.030222","7":"33.157422"},{"1":"educ_female","2":"4.526619","3":"0.7979735","4":"5.6726438","5":"0.00000015791484","6":"2.942002","7":"6.111236"},{"1":"high_gni","2":"11.703076","3":"11.3855645","4":"1.0278872","5":"0.30666890740928","6":"-10.906399","7":"34.312551"},{"1":"educ_female:high_gni","2":"-1.329906","3":"1.3906549","4":"-0.9563162","5":"0.34139185290995","6":"-4.091471","7":"1.431659"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The model explains 49.7% of the variation in contraception rates, <span class="math inline">\(F(3, 97) = 30.6\)</span>, <span class="math inline">\(p&lt;.001\)</span>. Examining the coefficient-level output, the interaction term is not statistically significant, <span class="math inline">\(p=0.341\)</span>, indicating that there may not be an interaction between female education level and wealth on contraception.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Augment model</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>out_1 <span class="ot">=</span> <span class="fu">augment</span>(lm<span class="fl">.1</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View augmented data</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>out_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["contraceptive"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["educ_female"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["high_gni"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".sigma"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[8],"type":["dbl"],"align":["right"]},{"label":[".std.resid"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"57","2":"5.9","3":"1","4":"55.65751","5":"1.34249276","6":"0.08752664","7":"14.48180","8":"0.00022828080037","9":"0.09756739"},{"1":"66","2":"8.9","3":"1","4":"65.24765","5":"0.75235237","6":"0.02168413","7":"14.48232","8":"0.00001545155047","9":"0.05280616"},{"1":"55","2":"10.5","3":"1","4":"70.36239","5":"-15.36238917","6":"0.03258073","7":"14.39070","8":"0.00989907365212","9":"-1.08431187"},{"1":"62","2":"4.6","3":"0","4":"45.91627","5":"16.08372937","6":"0.02012031","7":"14.38313","8":"0.00653143149216","9":"1.12798466"},{"1":"67","2":"10.5","3":"1","4":"70.36239","5":"-3.36238917","6":"0.03258073","7":"14.47815","8":"0.00047421248672","9":"-0.23732496"},{"1":"51","2":"9.2","3":"1","4":"66.20666","5":"-15.20666167","6":"0.02128908","7":"14.39360","8":"0.00619243355779","9":"-1.06711071"},{"1":"16","2":"2.0","3":"0","4":"34.14706","5":"-18.14706039","6":"0.03770633","7":"14.35354","8":"0.01615686917694","9":"-1.28426688"},{"1":"67","2":"8.4","3":"0","4":"63.11742","5":"3.88257596","6":"0.06905329","7":"14.47646","8":"0.00144717241198","9":"0.27935752"},{"1":"46","2":"7.2","3":"1","4":"59.81323","5":"-13.81323474","6":"0.04517860","7":"14.40735","8":"0.01139265369220","9":"-0.98137984"},{"1":"53","2":"8.7","3":"1","4":"64.60830","5":"-11.60830493","6":"0.02257267","7":"14.43071","8":"0.00383616506057","9":"-0.81513470"},{"1":"69","2":"10.6","3":"1","4":"70.68206","5":"-1.68206051","6":"0.03432456","7":"14.48144","8":"0.00012547913178","9":"-0.11883075"},{"1":"32","2":"1.9","3":"0","4":"33.69440","5":"-1.69439846","6":"0.03921132","7":"14.48142","8":"0.00014693742085","9":"-0.12000640"},{"1":"29","2":"2.2","3":"0","4":"35.05238","5":"-6.05238426","6":"0.03488049","7":"14.46829","8":"0.00165279496671","9":"-0.42769952"},{"1":"56","2":"3.2","3":"0","4":"39.57900","5":"16.42099642","6":"0.02443396","7":"14.37844","8":"0.00834113411826","9":"1.15418117"},{"1":"34","2":"5.1","3":"0","4":"48.17958","5":"-14.17958029","6":"0.02149518","7":"14.40523","8":"0.00543860514842","9":"-0.99514120"},{"1":"85","2":"12.3","3":"1","4":"76.11647","5":"8.88352660","6":"0.08309989","7":"14.45021","8":"0.00939880980238","9":"0.64406131"},{"1":"6","2":"0.6","3":"0","4":"27.80979","5":"-21.80979335","6":"0.06436156","7":"14.29049","8":"0.04213656736991","9":"-1.56530991"},{"1":"76","2":"9.6","3":"1","4":"67.48535","5":"8.51465295","6":"0.02251282","7":"14.45468","8":"0.00205819830913","9":"0.59788028"},{"1":"81","2":"7.0","3":"1","4":"59.17389","5":"21.82610795","6":"0.05031831","7":"14.29306","8":"0.03202344910366","9":"1.55485566"},{"1":"20","2":"2.1","3":"0","4":"34.59972","5":"-14.59972233","6":"0.03626272","7":"14.39930","8":"0.01002715861298","9":"-1.03244775"},{"1":"78","2":"8.4","3":"1","4":"63.64929","5":"14.35070910","6":"0.02484324","7":"14.40307","8":"0.00648263772796","9":"1.00887871"},{"1":"69","2":"10.5","3":"1","4":"70.36239","5":"-1.36238917","6":"0.03258073","7":"14.48182","8":"0.00007785372425","9":"-0.09616048"},{"1":"86","2":"12.1","3":"1","4":"75.47713","5":"10.52286930","6":"0.07548610","7":"14.43752","8":"0.01178295211681","9":"0.75976672"},{"1":"70","2":"7.7","3":"1","4":"61.41159","5":"8.58840853","6":"0.03451743","7":"14.45384","8":"0.00329094527618","9":"0.60679681"},{"1":"80","2":"7.4","3":"1","4":"60.45258","5":"19.54742257","6":"0.04053903","7":"14.33231","8":"0.02027418356292","9":"1.38541109"},{"1":"59","2":"5.3","3":"0","4":"49.08490","5":"9.91509585","6":"0.02247477","7":"14.44475","8":"0.00278598528738","9":"0.69620276"},{"1":"72","2":"6.1","3":"0","4":"52.70620","5":"19.29380040","6":"0.02884826","7":"14.33798","8":"0.01371913246726","9":"1.35918023"},{"1":"40","2":"1.4","3":"0","4":"31.43109","5":"8.56891120","6":"0.04765693","7":"14.45358","8":"0.00464874899240","9":"0.60958145"},{"1":"78","2":"10.9","3":"1","4":"71.64107","5":"6.35892545","6":"0.04030625","7":"14.46672","8":"0.00213216206873","9":"0.45063012"},{"1":"31","2":"5.9","3":"0","4":"51.80088","5":"-20.80087574","6":"0.02688662","7":"14.31471","8":"0.01480192536888","9":"-1.46387068"},{"1":"76","2":"9.9","3":"1","4":"68.44436","5":"7.55563891","6":"0.02474348","7":"14.46056","8":"0.00178941505069","9":"0.53114681"},{"1":"9","2":"0.8","3":"0","4":"28.71512","5":"-19.71511721","6":"0.05981713","7":"14.32656","8":"0.03169168064474","9":"-1.41154917"},{"1":"34","2":"3.2","3":"0","4":"39.57900","5":"-5.57900358","6":"0.02443396","7":"14.47056","8":"0.00096280729288","9":"-0.39213095"},{"1":"73","2":"5.3","3":"0","4":"49.08490","5":"23.91509585","6":"0.02247477","7":"14.26129","8":"0.01620799284848","9":"1.67923297"},{"1":"62","2":"11.2","3":"1","4":"72.60009","5":"-10.60008859","6":"0.04741325","7":"14.43821","8":"0.00707384144150","9":"-0.75398037"},{"1":"54","2":"3.2","3":"0","4":"39.57900","5":"14.42099642","6":"0.02443396","7":"14.40232","8":"0.00643304559603","9":"1.01360734"},{"1":"61","2":"6.9","3":"0","4":"56.32750","5":"4.67250494","6":"0.03914994","7":"14.47401","8":"0.00111548832238","9":"0.33092134"},{"1":"53","2":"4.4","3":"1","4":"50.86244","5":"2.13756295","6":"0.16264695","7":"14.48049","8":"0.00127706254622","9":"0.16216884"},{"1":"65","2":"9.7","3":"1","4":"67.80502","5":"-2.80501840","6":"0.02313134","7":"14.47952","8":"0.00022979757128","9":"-0.19702459"},{"1":"73","2":"9.8","3":"1","4":"68.12469","5":"4.87531026","6":"0.02387489","7":"14.47340","8":"0.00071759695643","9":"0.34257237"},{"1":"40","2":"11.2","3":"1","4":"72.60009","5":"-32.60008859","6":"0.04741325","7":"14.05764","8":"0.06690735966056","9":"-2.31883222"},{"1":"52","2":"9.4","3":"1","4":"66.84600","5":"-14.84600436","6":"0.02165088","7":"14.39775","8":"0.00600693030058","9":"-1.04199460"},{"1":"55","2":"10.2","3":"1","4":"69.40338","5":"-14.40337513","6":"0.02809945","7":"14.40222","8":"0.00743581179799","9":"-1.01427605"},{"1":"61","2":"5.4","3":"0","4":"49.53757","5":"11.46243392","6":"0.02305664","7":"14.43198","8":"0.00382433987328","9":"0.80509099"},{"1":"80","2":"11.1","3":"1","4":"72.28042","5":"7.71958276","6":"0.04491922","7":"14.45911","8":"0.00353578041483","9":"0.54837366"},{"1":"54","2":"3.8","3":"0","4":"42.29498","5":"11.70502483","6":"0.02111218","7":"14.42992","8":"0.00363711949810","9":"0.82131299"},{"1":"55","2":"7.6","3":"1","4":"61.09192","5":"-6.09192013","6":"0.03639960","7":"14.46808","8":"0.00175289818200","9":"-0.43083257"},{"1":"60","2":"6.8","3":"0","4":"55.87483","5":"4.12516687","6":"0.03764741","7":"14.47590","8":"0.00083348023442","9":"0.29192899"},{"1":"31","2":"2.3","3":"0","4":"35.50505","5":"-4.50504619","6":"0.03355963","7":"14.47466","8":"0.00087864051525","9":"-0.31813726"},{"1":"48","2":"4.8","3":"0","4":"46.82159","5":"1.17840551","6":"0.02048613","7":"14.48201","8":"0.00003572513002","9":"0.08265941"},{"1":"59","2":"3.4","3":"0","4":"40.48433","5":"18.51567256","6":"0.02308119","7":"14.35024","8":"0.00999000725509","9":"1.30050812"},{"1":"52","2":"9.2","3":"1","4":"66.20666","5":"-14.20666167","6":"0.02128908","7":"14.40495","8":"0.00540477556255","9":"-0.99693682"},{"1":"19","2":"5.4","3":"1","4":"54.05915","5":"-35.05915051","6":"0.10944088","7":"13.95499","8":"0.20436310851133","9":"-2.57912758"},{"1":"16","2":"1.4","3":"0","4":"31.43109","5":"-15.43108880","6":"0.04765693","7":"14.38841","8":"0.01507571622679","9":"-1.09774804"},{"1":"86","2":"9.5","3":"1","4":"67.16568","5":"18.83432430","6":"0.02201933","7":"14.34578","8":"0.00983986812606","9":"1.32217129"},{"1":"64","2":"8.0","3":"1","4":"62.37061","5":"1.62939449","6":"0.02962115","7":"14.48151","8":"0.00010062765093","9":"0.11483080"},{"1":"67","2":"8.1","3":"1","4":"62.69028","5":"4.30972314","6":"0.02823912","7":"14.47537","8":"0.00066923199307","9":"0.30350963"},{"1":"60","2":"9.6","3":"0","4":"68.54937","5":"-8.54936722","6":"0.10291920","7":"14.45193","8":"0.01126281231586","9":"-0.62664417"},{"1":"55","2":"8.5","3":"0","4":"63.57009","5":"-8.57008597","6":"0.07153787","7":"14.45282","8":"0.00734384659740","9":"-0.61745583"},{"1":"71","2":"3.2","3":"0","4":"39.57900","5":"31.42099642","6":"0.02443396","7":"14.09766","8":"0.03053978659046","9":"2.20848488"},{"1":"27","2":"0.8","3":"0","4":"28.71512","5":"-1.71511721","6":"0.05981713","7":"14.48137","8":"0.00023984692449","9":"-0.12279776"},{"1":"56","2":"6.3","3":"1","4":"56.93619","5":"-0.93619263","6":"0.07224585","7":"14.48219","8":"0.00008863866274","9":"-0.06747635"},{"1":"53","2":"2.4","3":"0","4":"35.95771","5":"17.04229188","6":"0.03230016","7":"14.36947","8":"0.01207049109980","9":"1.20270877"},{"1":"80","2":"4.8","3":"0","4":"46.82159","5":"33.17840551","6":"0.02048613","7":"14.05448","8":"0.02832013440911","9":"2.32730353"},{"1":"11","2":"0.8","3":"0","4":"28.71512","5":"-17.71511721","6":"0.05981713","7":"14.35673","8":"0.02558789762288","9":"-1.26835457"},{"1":"28","2":"4.2","3":"0","4":"44.10562","5":"-16.10562290","6":"0.02012522","7":"14.38286","8":"0.00655088899947","9":"-1.12952293"},{"1":"34","2":"3.3","3":"0","4":"40.03167","5":"-6.03166551","6":"0.02372688","7":"14.46855","8":"0.00109123467663","9":"-0.42379360"},{"1":"63","2":"9.6","3":"1","4":"67.48535","5":"-4.48534705","6":"0.02251282","7":"14.47481","8":"0.00057114373643","9":"-0.31495125"},{"1":"68","2":"7.5","3":"1","4":"60.77225","5":"7.22775122","6":"0.03840680","7":"14.46214","8":"0.00261443202998","9":"0.51169399"},{"1":"54","2":"8.8","3":"0","4":"64.92807","5":"-10.92807177","6":"0.07935988","7":"14.43378","8":"0.01347267713365","9":"-0.79068118"},{"1":"74","2":"8.0","3":"1","4":"62.37061","5":"11.62939449","6":"0.02962115","7":"14.43014","8":"0.00512600533948","9":"0.81957604"},{"1":"70","2":"10.4","3":"1","4":"70.04272","5":"-0.04271782","6":"0.03096194","7":"14.48254","8":"0.00000007249537","9":"-0.00301260"},{"1":"53","2":"3.1","3":"0","4":"39.12634","5":"13.87365835","6":"0.02520241","7":"14.40825","8":"0.00615093010969","9":"0.97552092"},{"1":"41","2":"4.0","3":"0","4":"43.20030","5":"-2.20029903","6":"0.02049595","7":"14.48069","8":"0.00012461334433","9":"-0.15434103"},{"1":"28","2":"3.4","3":"0","4":"40.48433","5":"-12.48432744","6":"0.02308119","7":"14.42255","8":"0.00454168617516","9":"-0.87687710"},{"1":"58","2":"9.2","3":"1","4":"66.20666","5":"-8.20666167","6":"0.02128908","7":"14.45669","8":"0.00180354360596","9":"-0.57589343"},{"1":"23","2":"2.0","3":"0","4":"34.14706","5":"-11.14706039","6":"0.03770633","7":"14.43400","8":"0.00609628620135","9":"-0.78887711"},{"1":"80","2":"11.6","3":"1","4":"73.87877","5":"6.12122603","6":"0.05863973","7":"14.46760","8":"0.00298746435564","9":"0.43798910"},{"1":"79","2":"11.8","3":"1","4":"74.51812","5":"4.48188334","6":"0.06500318","7":"14.47448","8":"0.00179962103197","9":"0.32177944"},{"1":"55","2":"9.8","3":"1","4":"68.12469","5":"-13.12468974","6":"0.02387489","7":"14.41617","8":"0.00520060850698","9":"-0.92222973"},{"1":"71","2":"9.5","3":"1","4":"67.16568","5":"3.83432430","6":"0.02201933","7":"14.47690","8":"0.00040781845317","9":"0.26916992"},{"1":"48","2":"7.3","3":"1","4":"60.13291","5":"-12.13290609","6":"0.04279630","7":"14.42471","8":"0.00828462341030","9":"-0.86092529"},{"1":"66","2":"7.4","3":"0","4":"58.59080","5":"7.40919528","6":"0.04758327","7":"14.46089","8":"0.00346966865618","9":"0.52706035"},{"1":"29","2":"10.0","3":"0","4":"70.36001","5":"-41.36001495","6":"0.11617193","7":"13.73703","8":"0.30652975079693","9":"-3.05421500"},{"1":"38","2":"4.5","3":"0","4":"45.46361","5":"-7.46360869","6":"0.02002947","7":"14.46119","8":"0.00139986730463","9":"-0.52341380"},{"1":"78","2":"7.0","3":"1","4":"59.17389","5":"18.82610795","6":"0.05031831","7":"14.34181","8":"0.02382520233611","9":"1.34114065"},{"1":"20","2":"3.3","3":"0","4":"40.03167","5":"-20.03166551","6":"0.02372688","7":"14.32747","8":"0.01203587805388","9":"-1.40745400"},{"1":"63","2":"5.5","3":"0","4":"49.99023","5":"13.00977199","6":"0.02369988","7":"14.41734","8":"0.00507065893877","9":"0.91407289"},{"1":"42","2":"4.3","3":"0","4":"44.55828","5":"-2.55828483","6":"0.02003193","7":"14.48003","8":"0.00016449107696","9":"-0.17940963"},{"1":"65","2":"11.2","3":"0","4":"75.79196","5":"-10.79195814","6":"0.16182241","7":"14.43030","8":"0.03232307841633","9":"-0.81834238"},{"1":"84","2":"12.8","3":"1","4":"77.71483","5":"6.28516987","6":"0.10432246","7":"14.46598","8":"0.00618947954389","9":"0.46104572"},{"1":"80","2":"8.7","3":"1","4":"64.60830","5":"15.39169507","6":"0.02257267","7":"14.39130","8":"0.00674423308034","9":"1.08080421"},{"1":"75","2":"8.7","3":"1","4":"64.60830","5":"10.39169507","6":"0.02257267","7":"14.44102","8":"0.00307420240687","9":"0.72970441"},{"1":"76","2":"5.2","3":"0","4":"48.63224","5":"27.36775778","6":"0.02195429","7":"14.19225","8":"0.02071214603456","9":"1.92115522"},{"1":"34","2":"1.2","3":"0","4":"30.52576","5":"3.47423506","6":"0.05146482","7":"14.47776","8":"0.00083189318997","9":"0.24764827"},{"1":"49","2":"5.8","3":"0","4":"51.34821","5":"-2.34821381","6":"0.02599787","7":"14.48042","8":"0.00018207018207","9":"-0.16518115"},{"1":"67","2":"6.7","3":"0","4":"55.42217","5":"11.57782880","6":"0.03620625","7":"14.43025","8":"0.00629528280894","9":"0.81872469"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual Plots</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> out_1, <span class="fu">aes</span>(<span class="at">x =</span> .resid)) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  educate<span class="sc">::</span><span class="fu">stat_density_confidence</span>(<span class="at">model =</span> <span class="st">"normal"</span>) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Residuals"</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> out_1, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Fitted values"</span>) <span class="sc">+</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Residuals"</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Layout</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-regression-diagnostics-2023_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>The model‚Äôs residuals do not seem to be consistent with the assumption of normality. Moreover, the assumption of homoskedasticity also seems to be violated, with the plot of the residuals versus the fitted values indicating increased variation in the residuals at higher fitted values. One question is whether the assumption violation is due to one or more extreme observations. For example, the three observations (54.1, -35.1), (70.4, -41.4) and (72.6, -32.6) all have extreme negative residuals. There are also a couple of observations that may have extreme positive residuals.</p>
<p><br></p>
</section>
<section id="identifying-extreme-observations" class="level1">
<h1>Identifying Extreme Observations</h1>
<p>In a regression analysis, there are several ways in which an observation may be extreme. The figure below shows three different ways in which an observation may be extreme.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-regression-diagnostics-2023_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Three different ways in which an observation may be extreme. The greenish observation is the extreme observation. The regression line is also displayed for the observations.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In Panel (a), the extreme observation has a large residual, but it‚Äôs <em>x</em>-value is similar to the <em>x</em>-values of the other observations. In Panel (b), the extreme observation has a large <em>x</em>-value relative to the other observations‚Äô <em>x</em>-values, but it does not have a large residual. In Panel (c), the extreme observation has both a large <em>x</em>-value relative to the other observations‚Äô <em>x</em>-values, and a large residual.</p>
<p>With extreme observations, we worry about whether the regression cioefficients, and thus the line, will be impacted. You can see how the regression line changes for each of these three types of outliers in the plot below.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-regression-diagnostics-2023_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Three different ways in which an observation may be extreme. The greenish observation is the extreme observation. The regression line is also displayed for the observations.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section" class="level1">
<h1></h1>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>